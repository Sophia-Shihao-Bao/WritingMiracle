<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
{% load static %}
<head>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
{#  <script src="https://cdn.bootcdn.net/ajax/libs/popper.js/2.9.2/cjs/popper.min.js"></script>#}
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.0.2/js/bootstrap.bundle.min.js"></script>
	<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="robots" content="index, follow" />
		<meta name="generator" content="RapidWeaver" />

	<meta name="twitter:card" content="summary">
	<meta name="twitter:title" content="Story Plot | 小作家神器">
	<meta name="twitter:image" content="https://sophiabao.com/diet/resources/photo-1474366521946-c3d4b507abf2.jpg">
	<meta name="twitter:url" content="https://sophiabao.com/diet/contact-form/index.php">
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="小作家神器">
	<meta property="og:title" content="Story Plot | 小作家神器">
	<meta property="og:image" content="https://sophiabao.com/diet/resources/photo-1474366521946-c3d4b507abf2.jpg">
	<meta property="og:url" content="https://sophiabao.com/diet/contact-form/index.php">

	<!-- Meta tags -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />

	<title>Story Plot | 小作家神器</title>
	<link rel="stylesheet" type="text/css" media="all" href="{% static 'Mountains/consolidated.css' %}" />


</head>

<!-- This page was created with RapidWeaver from Realmac Software. http://www.realmacsoftware.com -->

<body>
    <div class="hero" id="hero">
        <nav class="navbar navbar-expand-lg pt-3">
            <div class="container">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav mr-auto"><li class="nav-item"></li><li class="nav-item active"><a href="./" rel="" class="nav-link">Story Plot</a></li></ul>
                </div>
            </div>
        </nav>

        <div class="hero-content" id="hero2">
            <div class="container">
                <div class="row">
                    <div class="col">
						<img class="hero-background" href="{% static 'imgs/banner.jpg' %}">
						<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
                        <h1 class="hero-title display-1" data-aos-delay="300" data-aos-duration="500">小作家神器</h1>
                        <h2 class="hero-slogan font-italic display-4" data-aos-delay="350" data-aos-duration="500">主题写作增加创作灵感</h2>
                    </div>
                </div>
            </div>
        </div>

        <!--<div class="hero-background"></div>-->
    </div>
	<div id='stacks_out_1' class='stacks_top' style="padding-left:150px"><div id='stacks_in_1' class=''><div id='stacks_out_4' class='stacks_out'><div id='stacks_in_4' class='stacks_in com_yourhead_stack_header_stack'><h4 style="padding-left=100px;">Generating intresting plots that help start your story</h4></div></div><div id='stacks_out_10' class='stacks_out'><div id='stacks_in_10' class='stacks_in com_yourhead_stack_header_stack'><h4 style="padding-left=100px;">生成有趣的开头来帮你创作</h4></div></div><div id='stacks_out_18' class='stacks_out'><div id='stacks_in_18' class='stacks_in com_yourhead_stack_header_stack'><h5 style="padding-left=100px;">Facing a writing homework with an assigned topic and don't have any thoughts?</h5></div></div><div id='stacks_out_20' class='stacks_out'><div id='stacks_in_20' class='stacks_in com_yourhead_stack_header_stack'><h5 style="padding-left=100px;">Having a topic but having no interesting points?</h5></div></div><div id='stacks_out_24' class='stacks_out'><div id='stacks_in_24' class='stacks_in com_yourhead_stack_header_stack'><h5 style="padding-left=100px;">Following the same pattern of writing and having no new thoughts?</h5></div></div><div id='stacks_out_6' class='stacks_out'><div id='stacks_in_6' class='stacks_in com_yourhead_stack_header_stack'><h5 style="padding-left=100px;">This website help you to come up with intresting plots that could start an amazing piece of writing.</h5></div></div><div id='stacks_out_8' class='stacks_out'><div id='stacks_in_8' class='stacks_in com_yourhead_stack_header_stack'><h5 style="padding-left=100px;">看到命题作文没有思路吗？
	</h5></div></div><div id='stacks_out_28' class='stacks_out'><div id='stacks_in_28' class='stacks_in com_yourhead_stack_header_stack'><h5 style="padding-left=100px;">心中有了主题不知从何下笔吗？</h5></div></div><div id='stacks_out_26' class='stacks_out'><div id='stacks_in_26' class='stacks_in com_yourhead_stack_header_stack'><h5 style="padding-left=100px;">写作套路千篇一律没有新奇灵感吗？</h5></div></div><div id='stacks_out_30' class='stacks_out'><div id='stacks_in_30' class='stacks_in com_yourhead_stack_header_stack'><h5 style="padding-left=100px;">这个网站课一帮助您生成出来一系列好玩的故事开头</h5></div></div><div id='stacks_out_16' class='stacks_out'><div id='stacks_in_16' class='stacks_in com_yourhead_stack_header_stack'><h5 style="padding-left=100px;"></h5></div></div><div id='stacks_out_2' class='stacks_out'><div id='stacks_in_2' class='stacks_in com_yourhead_stack_button_stack'></div></div></div></div>

	<main class="content">
		<div class="container">
			<div class="row intro justify-content-between">
				<div class="col-sm-8 intro-col" data-aos-delay="300" data-aos-duration="500">

<div class="message-text"><?php echo $_SESSION['formMessage']; unset($_SESSION['formMessage']); ?></div><br />

	 <div>
		<label>Story General Topic 故事总主题</label> <br />
		<input class="form-input-field" id = "text" type="text" value="Your story General Topic 您故事的总主题" name="form[element0]" size="40"/><br /><br>
         <div id="text-container" style="width: 100%;display: flex;overflow-x: scroll">

         </div>
         <div style="text-align: center;visibility: hidden" id="loading">

            加载中, 请稍后，生成通常需要1分钟左右，请您耐心等待！

        </div>

		 <button class="form-input-button" type="submit" name="submitButton" value="Submit" onclick="submit()" >submit</button>
	</div>
</form>

<br />
<div class="form-footer"><?php echo $_SESSION['formFooter']; unset($_SESSION['formFooter']); ?></div><br />

<?php unset($_SESSION['form']); ?>

				</div>
				<div class="sidebar col-sm-4 order-md-8">
					<div class="logo" data-aos-delay="450" data-aos-duration="500">
						<img src="{% static 'imgs/logo.png' %}" width="376" height="260" alt="小作家神器"/>
                    </div>

                    <div class="mt-5">
                        <h3 class="sidebar-title">

                        </h3>


                    </div>
				</div>
			</div>
		</div>

		<div class="footer">
			<div class="container">
				<div class="row">
					<div class="col" data-aos-delay="0" data-aos-duration="500">
						<div class="footer-content text-center">
							&copy; 2021 Sophia BAO <a href="#" id="rw_email_contact">Contact Me</a><script type="text/javascript">var _rwObsfuscatedHref0 = "mai";var _rwObsfuscatedHref1 = "lto";var _rwObsfuscatedHref2 = ":so";var _rwObsfuscatedHref3 = "phi";var _rwObsfuscatedHref4 = "aba";var _rwObsfuscatedHref5 = "oz@";var _rwObsfuscatedHref6 = "icl";var _rwObsfuscatedHref7 = "oud";var _rwObsfuscatedHref8 = ".co";var _rwObsfuscatedHref9 = "m";var _rwObsfuscatedHref = _rwObsfuscatedHref0+_rwObsfuscatedHref1+_rwObsfuscatedHref2+_rwObsfuscatedHref3+_rwObsfuscatedHref4+_rwObsfuscatedHref5+_rwObsfuscatedHref6+_rwObsfuscatedHref7+_rwObsfuscatedHref8+_rwObsfuscatedHref9; document.getElementById("rw_email_contact").href = _rwObsfuscatedHref;</script>
                        </div>

						<ul class="navbar-nav mr-auto"><li class="nav-item"><a href="./" rel="" class="nav-link">Home</a></li></ul>
					</div>
				</div>
			</div>
		</div>
	</main>


</body>
<script>
        function sleep (time) {
          return new Promise((resolve) => setTimeout(resolve, time));
        }
        function submit() {
            const text = $('#text')
            const text_container = $('#text-container')
            const loading = $('#loading')
            loading.css('visibility', 'visible')
            text_container.html('')
             $.ajax({  //ajax 请求部分（核心代码部分）
                url: '{% url 'api:submit' %}',  //使用url导航，发送给content2img文件夹中的urls进行请求
                method: 'post',
                data: { text: text.val() },      //这里传输了一个字典格式的data，text来自于input框
                success: async function (res) {     //ajax异步加载结果，将返回的res的值放入下一个函数中
                    let loop = true
                    while (loop) {
                        $.ajax({
                        url: '{% url 'api:result' %}',      //同上，发送请求调用content2img里的urls，二次调用app中的urls
                        method: 'get',                      //调用了给出了函数中的get请求，需要注意，两次请求方式不同
                        data: {                             //这次传参传输刚才返回的res值中的task_id
                            task_id: res.task_id
                        },
                        success: function (res) {           //当有返回值后判断返回值长度，并添加图片
                            if (res.length !== 0){
                                loading.css('visibility', 'hidden')
                                loop = false
                                for (let i = 0; i < res.length; i++) {
                                    text_container.append(`<span>${res}</span>`)
                                }
                            }
                            }
                        })
                        await sleep(2000)
                    }
                }
            })
        }
    </script>

</html>